<?xml version="1.0" encoding="iso-8859-1"?>
<!-- 
	Authors: Josh Davidson (Octal450), Richard Harrison, Axel Paccalin.
	Version: 0.2
	
	Controller for the steering wheel output based on pilot command and ground speed. 
-->

<system name="Mirage-2000: FCS/FBW">
	<property value= "0.005">  fcs/fbw/steering/controller/input-gain </property>     <!-- Tuning param (gain for the controller input). -->

	<property value= "1.0"> fcs/fbw/steering/controller/Kp </property>  <!-- Tuning param (proportional coefficient for the controller). -->
	<property value= "1.0"> fcs/fbw/steering/controller/Ki </property>  <!-- Tuning param (integration coefficient for the controller). -->
	<property value= "0.0"> fcs/fbw/steering/controller/Kd </property>  <!-- Tuning param (derivative coefficient for the controller). -->
	
	<channel name="Steering">
		<fcs_function name="fcs/fbw/steering/controller/input">
			<function>
				<product>
					<p> fcs/fbw/steering/torque/k-error </p>
					<p> fcs/fbw/steering/controller/input-gain </p>
				</product>
			</function>
		</fcs_function>

		<!-- Controller integration blocking flag. -->
		<switch name="fcs/fbw/steering/controller/i-trigger">
			<default value="0"/>
			<test logic="OR" value="1">
				fcs/fbw/steering/output le -0.999
				fcs/fbw/steering/output ge  0.999

				gear/unit[0]/WOW ne 1
				
				fcs/fbw/steering/torque/p le 1
			</test>
		</switch>
		
		<!-- PID controller acting as the main driver for the roll channel. -->
		<pid name="fcs/fbw/steering/controller/c">
			<input> fcs/fbw/steering/controller/input </input>

			<kp> fcs/fbw/steering/controller/Kp </kp>
			<ki> fcs/fbw/steering/controller/Ki </ki>
			<kd> fcs/fbw/steering/controller/Kd </kd>

			<trigger> fcs/fbw/steering/controller/i-trigger </trigger>
			
			<clipto>
				<min> -1 </min>
				<max>  1 </max>
			</clipto>

			<output> fcs/fbw/steering/output </output>
		</pid>
	</channel>
</system>