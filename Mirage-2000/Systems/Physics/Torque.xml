<?xml version="1.0" encoding="iso-8859-1"?>
<!-- 
	Authors: Josh Davidson (Octal450), Richard Harrison, Axel Paccalin.
	Version: 0.2
	
	Controller for the steering wheel output based on pilot command and ground speed. 
-->

<system name="Mirage-2000: Torque">
	<channel name="Roll">
		<!-- The torque around the X axis (N.m). Induced by the aerodynamic forces and the engine thrust.  -->
		<fcs_function name="torque/aero/x">
			<function>
				<product>
					<sum>
						<!-- The torque around X due to the linear aerodynamic forces and the offset of CG relative of AeroRP in the YZ plane. -->
						<difference>
							<product>
								<p> aero/force/SIDE </p>
								<p> inertia/d-cg/z </p>
							</product>
							<product>
								<p> aero/force/LIFT </p>
								<p> inertia/d-cg/y </p>
							</product>
						</difference>

						<!-- The torque around X defined by the aerodynamic model. -->
						<product>
							<p> aero/force/ROLL </p>
							<p> units/ft-m </p>
						</product>

						<!-- The torque around X generated by the engine forces. -->
						<product>
							<p> moments/l-prop-lbsft </p>
							<p> units/ft-m </p>
						</product>
					</sum>

					<p> units/p-n </p>
				</product>
			</function>
		</fcs_function>

		<!-- The torque around the X axis (N.m). Induced by the rotational momentum and the moment of inertia.  -->
		<fcs_function name="torque/momentum/x">
			<function>
				<difference>
					<product> 
						<p> velocities/q-rad_sec </p>
						<p> momentum/angular/z </p>
					</product>
					<product>
						<p> velocities/r-rad_sec </p>
						<p> momentum/angular/y </p>
					</product>
				</difference>
			</function>
		</fcs_function>		
	</channel>
	<channel name="Pitch">
		<!-- The torque around the Y axis (N.m). Induced by the aerodynamic forces and the engine thrust.  -->
		<fcs_function name="torque/aero/y">
			<function>
				<product>
					<sum>
						<!-- The torque around Y due to linear aerodynamic forces and the offset of CG relative to AeroRP in the XZ plane. -->
						<difference>
							<product>
								<p> aero/force/LIFT </p>
								<p> inertia/d-cg/x </p>
							</product>
							<product>
								<p> aero/force/DRAG </p>
								<p> inertia/d-cg/z </p>
							</product>
						</difference>

						<!-- The torque around Y defined by the aerodynamic model. -->
						<product>
							<p> aero/force/PITCH </p>
							<p> units/ft-m </p>  <!-- p.ft => p.m -->
						</product>
						
						<!-- The torque around Y generated by the engine forces. -->
						<product>
							<p> moments/m-prop-lbsft </p>
							<p> units/ft-m </p>
						</product>
					</sum>

					<p> units/p-n </p>  <!-- p.m => N.m -->
				</product>
			</function>
		</fcs_function>

		<!-- The torque around the Y axis (N.m). Induced by the rotational momentum and the moment of inertia.  -->
		<fcs_function name="torque/momentum/y">
			<function>
				<difference>
					<product>
						<p> velocities/r-rad_sec </p>
						<p> momentum/angular/x </p>
					</product>
					<product>
						<p> velocities/p-rad_sec </p>
						<p> momentum/angular/z </p>
					</product>
				</difference>
			</function>
		</fcs_function>
	</channel>
	<channel name="Yaw">
		<!-- The torque around the Z axis (N.m). Induced by the aerodynamic forces and the engine thrust.  -->
		<fcs_function name="torque/aero/z">
			<function>
				<product>
					<sum>
						<!-- The torque around Z due to linear aerodynamic forces and the offset of CG relative to AeroRP in the XY plane. -->
						<difference>
							<product>
								<p> aero/force/DRAG </p>
								<p> inertia/d-cg/y </p>
							</product>
							<product>
								<p> aero/force/SIDE </p>
								<p> inertia/d-cg/x </p>
							</product>
						</difference>

						<!-- The torque around Z defined by the aerodynamic model. -->
						<product>
							<p> aero/force/YAW </p>
							<p> units/ft-m </p>  <!-- p.ft => p.m -->
						</product>

						<!-- The torque around X generated by the engine forces. -->
						<product>
							<p> moments/n-prop-lbsft </p>
							<p> units/ft-m </p>
						</product>
					</sum>

					<p> units/p-n </p>  <!-- p.m => N.m -->
				</product>
			</function>
		</fcs_function>

		<!-- The torque around the Z axis (N.m). Induced by the rotational momentum and the moment of inertia.  -->
		<fcs_function name="torque/momentum/z">
			<function>
				<difference>
					<product>
						<p> velocities/p-rad_sec </p>
						<p> momentum/angular/y </p>
					</product>
					<product>
						<p> velocities/q-rad_sec </p>
						<p> momentum/angular/x </p>
					</product>
				</difference>
			</function>
		</fcs_function>
	</channel>
</system>